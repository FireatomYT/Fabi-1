ALTER TABLE "guild" ADD "informBan" INTEGER NOT NULL DEFAULT 1; ALTER TABLE "guild" ADD "informKick" INTEGER NOT NULL DEFAULT 1; ALTER TABLE "guild" ADD "informMute" INTEGER NOT NULL DEFAULT 1; ALTER TABLE "guild" ADD "informStrike" INTEGER NOT NULL DEFAULT 1; ALTER TABLE "guild" ADD "informDelstrike" INTEGER NOT NULL DEFAULT 0
CREATE TABLE "menuSelectRoles" ("guildId" INTEGER NOT NULL, "userId" INTEGER NOT NULL, "targetId" INTEGER NOT NULL, "expiresAfter" INTEGER NOT NULL, "roles" TEXT, UNIQUE("guildId", "userId", "targetId")); UPDATE accessRole SET level=3 WHERE (level=2); UPDATE accessRole SET level=2 WHERE (level=1)
CREATE TABLE "gameChannels" ("guildId" INTEGER NOT NULL, "channelId" INTEGER NOT NULL, "maxStrikes" INTEGER NOT NULL DEFAULT 3, UNIQUE("guildId","channelId")); CREATE TABLE "gameStrikes" ("guildId" INTEGER NOT NULL, "channelId" INTEGER NOT NULL, "userId" INTEGER NOT NULL, "count" INTEGER NOT NULL, "lastUpdate" INTEGER, UNIQUE("channelId", "userId")); ALTER TABLE "strikeExpire" ADD "lastAddition" INTEGER; ALTER TABLE "guild" ADD "strikeCooldown" INTEGER DEFAULT 0; ALTER TABLE "ticketSettings" ADD "timeToReply" INTEGER NOT NULL DEFAULT 0; ALTER TABLE "ticket" ADD "replyWait" INTEGER DEFAULT 0
ALTER TABLE "guild" RENAME COLUMN "strikesExpire" TO "strikeExpire"
ALTER TABLE "logWebhooks" ADD "member" TEXT; DROP TABLE "strikeExpire"; CREATE TABLE "strikeExpire" ("guildId" INTEGER NOT NULL, "userId" INTEGER NOT NULL, "expiresAt" INTEGER NOT NULL, "count" INTEGER NOT NULL, "data" TEXT NOT NULL, "lastAddition" INTEGER, UNIQUE("guildId","userId"));
CREATE TABLE "cases_new" ("rowId" INTEGER, "localId" INTEGER, "type" INTEGER NOT NULL, "targetId" INTEGER NOT NULL, "targetTag" TEXT, "modId" INTEGER NOT NULL, "modTag" TEXT, "guildId" INTEGER NOT NULL, "reason" TEXT, "timeStart" INTEGER NOT NULL, "duration" INTEGER DEFAULT 0, "active" INTEGER NOT NULL DEFAULT 1, "logUrl" TEXT, PRIMARY KEY("rowId" AUTOINCREMENT)); INSERT INTO "cases_new" ("rowId", "type", "targetId", "targetTag", "modId", "modTag", "guildId", "reason", "timeStart", "duration", "active") SELECT "caseId", "type", "targetId", "targetTag", "modId", "modTag", "guildId", "reason", "timeStart", "duration", "active" FROM "cases"; WITH CTE AS (SELECT rowId, ROW_NUMBER() OVER (PARTITION BY guildId ORDER BY timeStart) AS localId FROM "cases_new") UPDATE "cases_new" SET localId = (SELECT localId FROM CTE WHERE CTE.rowId = cases_new.rowId); DROP TABLE "cases"; ALTER TABLE "cases_new" RENAME TO "cases";
CREATE TABLE "persistentRole" ("roleId" INTEGER NOT NULL UNIQUE, "guildId" INTEGER NOT NULL); CREATE TABLE "returnRole" ("guildId" INTEGER NOT NULL, "userId" INTEGER NOT NULL, "roleIds" TEXT NOT NULL, "expiresAfter" INTEGER, UNIQUE("guildId","userId")); ALTER TABLE "ticketSettings" ADD "roleSupport" TEXT;
ALTER TABLE "guild" ADD "roleWhitelist" INTEGER DEFAULT 0
CREATE TABLE "verifySettings_new" ("guildId" INTEGER NOT NULL UNIQUE, "roleId" INTEGER, "panelText" TEXT, "panelImage" TEXT); INSERT INTO "verifySettings_new" ("guildId", "roleId", "panelText", "panelImage") SELECT "guildId", "roleId", "panelText", "panelImage" FROM "verifySettings"; DROP TABLE "verifySettings"; ALTER TABLE "verifySettings_new" RENAME TO "verifySettings";
ALTER TABLE "ticketSettings" ADD "deletePing" INTEGER DEFAULT 1
ALTER TABLE "ticketSettings" ADD "allowClose" INTEGER DEFAULT 0; ALTER TABLE "ticketSettings" ADD "transcripts" INTEGER DEFAULT 1
CREATE TABLE "modReport" ("guildId" INTEGER NOT NULL UNIQUE, "channelId" INTEGER NOT NULL, "roleIds" INTEGER NOT NULL, "nextReport" INTEGER NOT NULL, "interval" INTEGER NOT NULL DEFAULT 7)
CREATE TABLE "botBlacklist" ("id" INTEGER NOT NULL UNIQUE); ALTER TABLE "verifySettings" ADD "additionalRoles" TEXT;
ALTER TABLE "groups" ADD "appealGuildId" INTEGER;
ALTER TABLE "logWebhooks" ADD "level" TEXT; CREATE TABLE "levelSettings" ("guildId" INTEGER NOT NULL UNIQUE, "enabled" INTEGER NOT NULL DEFAULT 0, "voiceEnabled" INTEGER NOT NULL DEFAULT 1, "exemptChannels" TEXT); CREATE TABLE "levelPlayers" ("userId" INTEGER NOT NULL, "guildId" INTEGER NOT NULL, "textExp" INTEGER DEFAULT 0, "voiceExp" INTEGER DEFAULT 0, "globalExp" INTEGER DEFAULT 0, "voiceTime" INTEGER DEFAULT 0, "lastUpdate" INTEGER DEFAULT 0, UNIQUE("userId","guildId")); CREATE TABLE "levelRoles" ("guildId" INTEGER NOT NULL, "level" INTEGER NOT NULL, "roles" TEXT NOT NULL, "exact" INTEGER DEFAULT 1, "type" INTEGER DEFAULT 0, UNIQUE("guildId","level","type"));
ALTER TABLE "logWebhooks" ADD "bot" TEXT;
CREATE TABLE "autopunish_new" ("guildId" INTEGER NOT NULL, "strike" INTEGER NOT NULL, "actions" INTEGER NOT NULL, "data" TEXT, UNIQUE("guildId","strike")); INSERT INTO "autopunish_new"("guildId", "strike", "actions", "data") SELECT "guildId", "strike", "actions", "data" FROM "autopunish"; DROP TABLE "autopunish"; ALTER TABLE "autopunish_new" RENAME TO "autopunish";
ALTER TABLE "guild" ADD "drama" INTEGER DEFAULT 0; ALTER TABLE "guild" ADD "dramaChannel" INTEGER;
ALTER TABLE "blacklist" RENAME TO "serverBlacklist"; DROP TABLE "botBlacklist"; CREATE TABLE "blacklist" ("id" INTEGER NOT NULL UNIQUE, "type" INTEGER NOT NULL, "expiresIn" INTEGER, "reason" TEXT)
ALTER TABLE "guild" ADD "locale" TEXT